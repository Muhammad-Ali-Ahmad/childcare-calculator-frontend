@*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.childcarecalculatorfrontend.FrontendAppConfig
@import uk.gov.hmrc.childcarecalculatorfrontend.controllers.routes._
@import uk.gov.hmrc.childcarecalculatorfrontend.models.views.ResultsViewModel
@import uk.gov.hmrc.childcarecalculatorfrontend.utils.Utils
@import uk.gov.hmrc.childcarecalculatorfrontend.controllers.routes

@import uk.gov.hmrc.childcarecalculatorfrontend.utils.UserAnswers
@(appConfig: FrontendAppConfig, model: ResultsViewModel, links: List[Map[String, String]], summary: Option[String], utils: Utils)(implicit request: Request[_], messages: Messages)

@pagetitle = {
    @if(model.noOfEligibleSchemes > 0){
        @messages("result.heading")
    } else {
        @messages("result.heading.not.eligible")
    }
}

@main_template(
    title = pagetitle.toString.trim,
    appConfig = appConfig,
    bodyClasses = Some("result")) {

    @components.back_link()

    @components.heading(pagetitle.toString, "heading-xlarge")

    <p>@model.firstParagraph</p>

    @if(model.noOfEligibleSchemes > 0) {

        <h2 class="resultEligibleHeading visuallyhidden">
            @if(model.noOfEligibleSchemes == 1) {
                @messages("result.single.eligibility.heading")
            } else {
                @messages("result.multiple.eligibility.heading", model.noOfEligibleSchemes)
            }
        </h2>

        @resultEligible(model, utils)

        @if(model.noOfEligibleSchemes < 4) {

            <h2 class="resultNotEligibleHeading visuallyhidden">@messages("result.not.eligible.title")</h2>
            @resultNotEligible(model)
        }

        @if(model.noOfEligibleSchemes > 1) {

            <h2 class="heading-medium">@messages("result.more.info.title")</h2>

            @if(model.noOfEligibleSchemes == 4) {
                <p>@messages("result.more.info.para")</p>
                <ul class="bullets">
                    <li>@messages("result.schemes.free.hours.eligibility.guidance.with.tc.bullet")</li>
                    <li>@messages("result.schemes.tfc.tc.vouchers.eligibility.guidance")</li>
                </ul>
            } else if(model.isEligibleForAllButVouchers) {
                <p>@messages("result.more.info.para")</p>
                <ul class="bullets">
                    <li>@messages("result.schemes.free.hours.eligibility.guidance.with.tc.bullet")</li>
                    <li>@messages("result.schemes.tfc.ineligibility.taxCredits.guidance.bullet")</li>
                </ul>
            } else if(model.isEligibleForAllButTc) {
                <p>@messages("result.more.info.para")</p>
                <ul class="bullets">
                    <li>@messages("")</li>
                    <li>@messages("")</li>
                </ul>
            } else {
                @if(model.freeHours.nonEmpty) {

                    @if(model.tc.nonEmpty) {
                        <p>@messages("result.schemes.free.hours.eligibility.guidance.with.tc.para")</p>
                    } else {
                        <p>@messages("result.schemes.free.hours.eligibility.guidance")</p>
                    }
                }

                @if(model.isEligibleOnlyForTCAndEsc) {
                    <p>@messages("result.schemes.tax.credit.eligibility.with.vouchers.guidance")</p>
                }

                @if(model.isEligibleForTfcAndEsc) {
                    <p>@messages("result.schemes.tfc.ineligibility.vouchers.guidance")</p>
                }
                @if(model.isEligibleForTCAndTfc) {
                    <p>@messages("result.schemes.tfc.ineligibility.taxCredits.guidance.para")</p>
                }
            }
        }

        <div class="moreInfo">
            <h2 class="heading-medium">@messages("aboutYourResults.more.info.title")</h2>
            <p>@messages("aboutYourResults.more.info.para1")</p>
            @if(links.nonEmpty) {
            <ul class="list list-bullet">
                @for(link <- links) {
                <li><a href=@link("link")>@link("title")</a></li>
                }
            </ul>
            }
            <p>@summary.getOrElse("")</p>
        </div>

    } else {
        <h2 class="resultNotEligibleHeading visually-hidden">@messages("result.not.eligible.title")</h2>
        @resultNotEligible(model)
    }
    <div class="panel panel-border-wide survey">
        <p> <a rel="external" target="_blank" id="feedbackSurveyLink" href="@routes.FeedbackSurveyController.loadFeedbackSurvey">
            @messages("results.feedback.survey.link.text") <span class="visually-hidden">@messages("feedback.hint.link.opens.new.window")</span></a> @messages("results.feedback.survey.text.after.link")
        </p>
    </div>
}
